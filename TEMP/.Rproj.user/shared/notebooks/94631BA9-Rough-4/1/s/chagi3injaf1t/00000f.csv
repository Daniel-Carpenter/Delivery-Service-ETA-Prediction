"0",""
"0","# Transforming the revenue"
"0",""
"0","# transformed_revenue <- df.train.base %>%"
"0","#   group_by(custId) %>%"
"0","#   summarise(targetRevenue = log(sum(revenue)) + 1) %>%"
"0","#   ungroup()"
"0",""
"0",""
"0","#aggregate revenue"
"0","CustRev <- stats::aggregate(df.train.base$revenue, "
"0","                     by=list(df.train.base$custId),"
"0","                     FUN = sum,"
"0","                     na.rm = TRUE)"
"0",""
"0","#renaming fields"
"0","names(CustRev) <- c('custId', 'totalRevenue')"
"0",""
"0","#merging datasets"
"0","df.train.merge <- merge(df.train.base, CustRev, by='custId')"
"0",""
"0","#applying transformation"
"0","df.train.merge$totalRevenue <- df.train.merge$totalRevenue + 1"
"0","df.train.merge$totalRevenue <- log(df.train.merge$totalRevenue)"
"0",""
"0",""
"0",""
